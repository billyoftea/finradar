# ğŸ“Š æ¯æ—¥å¸‚åœºè¿½è¸ªæœåŠ¡ - éƒ¨ç½²æŒ‡å—

## ç›®å½•

- [åŠŸèƒ½æ¦‚è¿°](#åŠŸèƒ½æ¦‚è¿°)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [è¯¦ç»†éƒ¨ç½²æ­¥éª¤](#è¯¦ç»†éƒ¨ç½²æ­¥éª¤)
- [å¯†é’¥é…ç½®ä¸æ›´æ–°](#å¯†é’¥é…ç½®ä¸æ›´æ–°)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## åŠŸèƒ½æ¦‚è¿°

æ¯æ—¥å¸‚åœºè¿½è¸ªæœåŠ¡è‡ªåŠ¨æŠ“å–ä»¥ä¸‹æ•°æ®æºï¼Œç”Ÿæˆç»¼åˆå¸‚åœºæŠ¥å‘Šï¼š

| æ•°æ®æº | è¯´æ˜ | ä¾èµ–æœåŠ¡ |
|-------|------|---------|
| ğŸ‡¨ğŸ‡³ Aè‚¡å¸‚åœº | ä¸Šè¯ã€æ·±è¯ã€åˆ›ä¸šæ¿ç­‰æŒ‡æ•° | æ—  |
| ğŸ¥‡ è´µé‡‘å± | é»„é‡‘ã€ç™½é“¶ä»·æ ¼ | æ—  |
| â‚¿ åŠ å¯†è´§å¸ | BTCã€ETHã€SOL ç­‰ | æ—  |
| ğŸ“ˆ æœŸè´§å¸‚åœº | å•†å“æœŸè´§æ•°æ® | æ—  |
| ğŸ’» GitHub | çƒ­é—¨å¼€æºé¡¹ç›® | æ—  |
| ğŸ¦ Twitter | è´¢ç»/åŠ å¯† KOL åŠ¨æ€ | Nitter å®ä¾‹ |
| ğŸ“± å¾®ä¿¡å…¬ä¼—å· | è´¢ç»åª’ä½“æ–‡ç«  | wechat-article-exporter |

---

## å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Ubuntu 20.04+ æœåŠ¡å™¨
- Docker å’Œ Docker Compose
- Git

### ä¸€é”®éƒ¨ç½²ï¼ˆæœ€å°åŒ–é…ç½®ï¼‰

```bash
# 1. å…‹éš†é¡¹ç›®
git clone git@github.com:billyoftea/finradar.git
cd finradar

# 2. å¯åŠ¨åŸºç¡€æœåŠ¡ï¼ˆä¸å« Twitter å’Œå¾®ä¿¡ï¼‰
cd docker
sudo docker compose -f docker-compose-market.yml up -d

# 3. æŸ¥çœ‹è¿è¡Œæ—¥å¿—
sudo docker logs finradar-market --tail 100
```

> âš ï¸ æœ€å°åŒ–é…ç½®ä¸‹ï¼ŒTwitter å’Œå¾®ä¿¡å…¬ä¼—å·æ•°æ®å°†ä¸ºç©ºã€‚å¦‚éœ€å®Œæ•´åŠŸèƒ½ï¼Œè¯·ç»§ç»­é˜…è¯»ä¸‹æ–¹è¯¦ç»†éƒ¨ç½²æ­¥éª¤ã€‚

---

## è¯¦ç»†éƒ¨ç½²æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½² Nitterï¼ˆTwitter æ•°æ®æºï¼‰

Nitter æ˜¯ Twitter çš„å¼€æºæ›¿ä»£å‰ç«¯ï¼Œç”¨äºè·å– Twitter RSS è®¢é˜…ã€‚

```bash
cd finradar/fin_module/nitter

# å¯åŠ¨ Nitter æœåŠ¡
sudo docker compose up -d

# éªŒè¯æœåŠ¡è¿è¡Œ
curl http://localhost:8080/elonmusk/rss
```

#### é…ç½® Twitter Token

1. **åœ¨æµè§ˆå™¨ä¸­ç™»å½• Twitter** (https://twitter.com)

2. **è·å– Cookie**:
   - æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·
   - åˆ‡æ¢åˆ° `Application` â†’ `Cookies` â†’ `https://twitter.com`
   - æ‰¾åˆ°ä»¥ä¸‹ä¸¤ä¸ªå€¼ï¼š
     - `auth_token`
     - `ct0`

3. **æ›´æ–°é…ç½®æ–‡ä»¶**:
   ```bash
   # ç¼–è¾‘ sessions.jsonl
   nano fin_module/nitter/sessions.jsonl
   ```
   
   æ–‡ä»¶å†…å®¹æ ¼å¼ï¼š
   ```json
   {"kind": "cookie", "auth_token": "ä½ çš„auth_tokenå€¼", "ct0": "ä½ çš„ct0å€¼", "id": "ä½ çš„Twitterç”¨æˆ·ID"}
   ```

4. **é‡å¯ Nitter æœåŠ¡**:
   ```bash
   cd fin_module/nitter
   sudo docker compose restart
   ```

---

### ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²å¾®ä¿¡å…¬ä¼—å·æœåŠ¡

wechat-article-exporter ç”¨äºæŠ“å–å¾®ä¿¡å…¬ä¼—å·æ–‡ç« ã€‚

```bash
cd finradar/fin_module/wechat-article

# å¯åŠ¨æœåŠ¡
sudo docker compose up -d

# éªŒè¯æœåŠ¡è¿è¡Œ
curl http://localhost:3001/
```

#### ç™»å½•å¹¶è·å– Auth Key

1. **è®¿é—®æœåŠ¡ç•Œé¢**:
   - æ‰“å¼€æµè§ˆå™¨è®¿é—®: `http://ä½ çš„æœåŠ¡å™¨IP:3001`
   - ä½¿ç”¨å¾®ä¿¡æ‰«æäºŒç»´ç ç™»å½•

2. **è·å– Auth Key**:
   ```bash
   # ç™»å½•æˆåŠŸåï¼ŒæŸ¥çœ‹ cookie ç›®å½•
   ls fin_module/wechat-article/data/kv/cookie/
   
   # è¾“å‡ºç±»ä¼¼ï¼š03a7d7d5c19449879ccebbd5f1a4947f
   # è¿™ä¸ªæ–‡ä»¶åå°±æ˜¯ä½ çš„ auth_key
   ```

3. **æ›´æ–°é…ç½®æ–‡ä»¶**:
   ```bash
   nano config/config.yaml
   ```
   
   æ‰¾åˆ° `wechat` éƒ¨åˆ†ï¼Œæ›´æ–° `auth_key`:
   ```yaml
   wechat:
     enabled: true
     service_url: "http://ä½ çš„æœåŠ¡å™¨å†…ç½‘IP:3001"
     auth_key: "ä½ çš„auth_keyå€¼"  # ä» cookie ç›®å½•è·å–çš„æ–‡ä»¶å
   ```

---

### ç¬¬ä¸‰æ­¥ï¼šæ›´æ–°ä¸»é…ç½®æ–‡ä»¶

ç¼–è¾‘ `config/config.yaml`ï¼Œé…ç½®æœåŠ¡åœ°å€ï¼š

```yaml
# Twitter/Nitter é…ç½®
twitter:
  enabled: true
  nitter_instance: "http://ä½ çš„æœåŠ¡å™¨å†…ç½‘IP:8080"
  accounts:
    finance:
      - "unusual_whales"
      - "WatcherGuru"
      # ... æ›´å¤šè´¦å·

# å¾®ä¿¡å…¬ä¼—å·é…ç½®
wechat:
  enabled: true
  service_url: "http://ä½ çš„æœåŠ¡å™¨å†…ç½‘IP:3001"
  auth_key: "ä½ çš„auth_key"
  accounts:
    finance:
      - "è´¢è”ç¤¾"
      - "è´¢ç»æ‚å¿—"
      # ... æ›´å¤šå…¬ä¼—å·
```

> ğŸ’¡ **æç¤º**: æœåŠ¡å™¨å†…ç½‘ IP å¯é€šè¿‡ `hostname -I` è·å–

---

### ç¬¬å››æ­¥ï¼šå¯åŠ¨å¸‚åœºè¿½è¸ªæœåŠ¡

```bash
cd finradar

# æ„å»º Docker é•œåƒ
sudo docker build -f docker/Dockerfile.market -t finradar-market:latest .

# å¯åŠ¨æœåŠ¡
cd docker
sudo docker compose -f docker-compose-market.yml up -d

# æŸ¥çœ‹æ—¥å¿—éªŒè¯
sudo docker logs finradar-market --tail 150
```

---

## å¯†é’¥é…ç½®ä¸æ›´æ–°

### ğŸ”‘ ä¸¤ä¸ªå…³é”®å¯†é’¥

| å¯†é’¥ | ç”¨é€” | æœ‰æ•ˆæœŸ | ä½ç½® |
|-----|------|-------|------|
| **Twitter Token** | Nitter è®¿é—® Twitter API | çº¦ 30-90 å¤© | `fin_module/nitter/sessions.jsonl` |
| **å¾®ä¿¡ Auth Key** | è®¿é—®å¾®ä¿¡å…¬ä¼—å· API | çº¦ 4 å¤© | `config/config.yaml` ä¸­çš„ `wechat.auth_key` |

---

### ğŸ¦ Twitter Token æ›´æ–°

#### ä»€ä¹ˆæ—¶å€™éœ€è¦æ›´æ–°ï¼Ÿ

å½“æ—¥å¿—å‡ºç°ä»¥ä¸‹é”™è¯¯æ—¶ï¼š
```
[sessions] no sessions available for API
HTTP 429 from http://xxx:8080
```

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ä¸€é”®æ›´æ–°è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd finradar

# è¿è¡Œè„šæœ¬ï¼ŒæŒ‰æç¤ºè¾“å…¥ auth_token å’Œ ct0
./scripts/update-twitter-token.sh

# æˆ–ç›´æ¥ä¼ å…¥å‚æ•°
./scripts/update-twitter-token.sh "ä½ çš„auth_token" "ä½ çš„ct0"
```

#### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨æ›´æ–°

1. **è·å–æ–° Token**:
   - ç™»å½• https://twitter.com
   - F12 â†’ Application â†’ Cookies
   - å¤åˆ¶ `auth_token` å’Œ `ct0` å€¼

2. **æ›´æ–°é…ç½®**:
   ```bash
   # ç¼–è¾‘ sessions.jsonl
   nano fin_module/nitter/sessions.jsonl
   
   # æ›´æ–°ä¸ºæ–°çš„ token
   {"kind": "cookie", "auth_token": "æ–°çš„auth_token", "ct0": "æ–°çš„ct0", "id": "ä½ çš„ç”¨æˆ·ID"}
   ```

3. **é‡å¯æœåŠ¡**:
   ```bash
   cd fin_module/nitter
   sudo docker compose restart
   
   # éªŒè¯
   curl http://localhost:8080/elonmusk/rss | head -20
   ```

---

### ğŸ“± å¾®ä¿¡ Auth Key æ›´æ–°

#### ä»€ä¹ˆæ—¶å€™éœ€è¦æ›´æ–°ï¼Ÿ

å½“æ—¥å¿—å‡ºç°ä»¥ä¸‹é”™è¯¯æ—¶ï¼š
```
æœç´¢å…¬ä¼—å·å¤±è´¥: è®¤è¯ä¿¡æ¯æ— æ•ˆ
å¾®ä¿¡å…¬ä¼—å·æ–‡ç« æŠ“å–å®Œæˆï¼Œå…± 0 ç¯‡
```

æˆ–è€…è·ç¦»ä¸Šæ¬¡ç™»å½•è¶…è¿‡ **4 å¤©**ã€‚

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ä¸€é”®æ›´æ–°è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd finradar

# å…ˆåœ¨æµè§ˆå™¨ä¸­ç™»å½•å¾®ä¿¡æœåŠ¡ï¼ˆæ‰«ç ï¼‰
# è®¿é—®: http://ä½ çš„æœåŠ¡å™¨IP:3001

# ç„¶åè¿è¡Œè„šæœ¬ï¼Œè‡ªåŠ¨è·å–æœ€æ–° key å¹¶æ›´æ–°
./scripts/update-wechat-key.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. ä» cookie ç›®å½•æ‰¾åˆ°æœ€æ–°çš„ auth_key
2. æ›´æ–° config.yaml
3. é‡å»ºå¹¶é‡å¯ Docker æœåŠ¡

#### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨æ›´æ–°

1. **é‡æ–°ç™»å½•å¾®ä¿¡æœåŠ¡**:
   - è®¿é—® `http://ä½ çš„æœåŠ¡å™¨IP:3001`
   - å¾®ä¿¡æ‰«ç ç™»å½•

2. **è·å–æ–°çš„ Auth Key**:
   ```bash
   # æŸ¥çœ‹ cookie ç›®å½•ï¼Œæ‰¾æœ€æ–°çš„æ–‡ä»¶
   ls -lt fin_module/wechat-article/data/kv/cookie/
   
   # æœ€æ–°çš„æ–‡ä»¶åå°±æ˜¯æ–°çš„ auth_key
   ```

3. **æ›´æ–°é…ç½®**:
   ```bash
   nano config/config.yaml
   
   # æ›´æ–° wechat.auth_key ä¸ºæ–°å€¼
   ```

4. **é‡å»ºå¹¶é‡å¯æœåŠ¡**:
   ```bash
   cd finradar
   sudo docker build -f docker/Dockerfile.market -t finradar-market:latest .
   
   cd docker
   sudo docker compose -f docker-compose-market.yml down
   sudo docker compose -f docker-compose-market.yml up -d
   ```

---

### â° å»ºè®®çš„æ›´æ–°å‘¨æœŸ

| å¯†é’¥ | å»ºè®®æ›´æ–°å‘¨æœŸ | è‡ªåŠ¨åŒ–å»ºè®® |
|-----|------------|-----------|
| Twitter Token | æ¯ 30 å¤©æ£€æŸ¥ä¸€æ¬¡ | è®¾ç½®æ—¥å†æé†’ |
| å¾®ä¿¡ Auth Key | æ¯ 3 å¤©æ›´æ–°ä¸€æ¬¡ | è®¾ç½®æ—¥å†æé†’ |

> ğŸ’¡ **å°æŠ€å·§**: å¯ä»¥è®¾ç½® cron ä»»åŠ¡æ¯å¤©æ£€æŸ¥æ—¥å¿—ä¸­æ˜¯å¦æœ‰è®¤è¯é”™è¯¯

---

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æŸ¥çœ‹æœåŠ¡è¿è¡ŒçŠ¶æ€ï¼Ÿ

```bash
# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨çŠ¶æ€
sudo docker ps

# æŸ¥çœ‹å¸‚åœºæœåŠ¡æ—¥å¿—
sudo docker logs finradar-market --tail 100

# æŸ¥çœ‹ Nitter æ—¥å¿—
sudo docker logs nitter --tail 50

# æŸ¥çœ‹å¾®ä¿¡æœåŠ¡æ—¥å¿—
sudo docker logs wechat-article-exporter --tail 50
```

### Q: å¦‚ä½•æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡æ•°æ®æŠ“å–ï¼Ÿ

```bash
sudo docker exec finradar-market python -m fin_module
```

### Q: æ•°æ®ä¿å­˜åœ¨å“ªé‡Œï¼Ÿ

- æŠ¥å‘Šæ–‡ä»¶: `output/market/market_report_YYYYMMDD.txt`
- JSON æ•°æ®: `output/market/market_data_YYYYMMDD.json`

### Q: å¦‚ä½•ä¿®æ”¹æŠ“å–é¢‘ç‡ï¼Ÿ

ç¼–è¾‘ `docker/entrypoint-market.sh`ï¼Œä¿®æ”¹ cron è¡¨è¾¾å¼ï¼š
```bash
# é»˜è®¤æ¯ 30 åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
CRON_SCHEDULE="${CRON_SCHEDULE:-*/30 * * * *}"

# æ”¹ä¸ºæ¯å°æ—¶
CRON_SCHEDULE="${CRON_SCHEDULE:-0 * * * *}"
```

### Q: AWS å®‰å…¨ç»„éœ€è¦å¼€æ”¾å“ªäº›ç«¯å£ï¼Ÿ

| ç«¯å£ | æœåŠ¡ | è¯´æ˜ |
|-----|------|------|
| 3001 | å¾®ä¿¡æœåŠ¡ | ç”¨äºæ‰«ç ç™»å½• |
| 8080 | Nitter | å¯é€‰ï¼Œç”¨äºè°ƒè¯• |

---

## æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    finradar-market                       â”‚
â”‚                   (Docker Container)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              fin_module/__main__.py              â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ Aè‚¡/æœŸè´§  â”‚ â”‚ åŠ å¯†è´§å¸  â”‚ â”‚    GitHub API    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ (AkShare) â”‚ â”‚(CoinGecko)â”‚ â”‚                  â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚   Twitter RSS    â”‚ â”‚   å¾®ä¿¡å…¬ä¼—å· API     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ (via Nitter)     â”‚ â”‚ (via wechat-export) â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                      â”‚
               â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Nitter          â”‚  â”‚   wechat-article-exporter    â”‚
â”‚   (Port 8080)        â”‚  â”‚        (Port 3001)           â”‚
â”‚                      â”‚  â”‚                              â”‚
â”‚ sessions.jsonl       â”‚  â”‚  data/kv/cookie/auth_key     â”‚
â”‚ (Twitter Token)      â”‚  â”‚  (å¾®ä¿¡ Auth Key)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## è”ç³»ä¸æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æäº¤ Issue æˆ–è”ç³»ç»´æŠ¤è€…ã€‚

---

*æ–‡æ¡£æ›´æ–°æ—¥æœŸ: 2026-02-03*
